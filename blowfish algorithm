import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import javax.crypto.BadPaddingException;
import javax.crypto.Cipher;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.KeyGenerator;
import javax.crypto.NoSuchPaddingException;
import javax.crypto.SecretKey;
import java.util.Scanner;
import java.util.Base64;

public class BlowfishExample {
    public static void main(String[] argv) {
        try {
            System.out.println("Message Encryption Using Blowfish Algorithm\n-------");

            Scanner sc = new Scanner(System.in);
            KeyGenerator keygenerator = KeyGenerator.getInstance("Blowfish");
            SecretKey secretkey = keygenerator.generateKey();

            Cipher cipher = Cipher.getInstance("Blowfish");

            System.out.println("Enter the plaintext:");
            String plaintext = sc.nextLine();

            byte[] text = plaintext.getBytes();
            System.out.println("Message [Byte Format]: " + java.util.Arrays.toString(text));

            
            cipher.init(Cipher.ENCRYPT_MODE, secretkey);
            byte[] textEncrypted = cipher.doFinal(text);
            System.out.println("Encrypted Message (Base64): " + Base64.getEncoder().encodeToString(textEncrypted));

            
            cipher.init(Cipher.DECRYPT_MODE, secretkey);
            byte[] textDecrypted = cipher.doFinal(textEncrypted);
            System.out.println("Decrypted Message: " + new String(textDecrypted));

            sc.close();
        } catch (NoSuchAlgorithmException | NoSuchPaddingException |
                 InvalidKeyException | IllegalBlockSizeException |
                 BadPaddingException e) {
            e.printStackTrace();
        }
    }
}
